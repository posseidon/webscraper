function handleCustomAccordionClick(e){e.preventDefault(),e.stopPropagation();var t,e=this,a=e.getAttribute("data-accordion-target"),a=document.querySelector(a),r=e.closest("[data-custom-accordion]");a&&r&&(t=!a.classList.contains("hidden"),r.querySelectorAll("[data-accordion-target]").forEach(e=>{var t=e.getAttribute("data-accordion-target"),t=document.querySelector(t),a=e.querySelector("[data-accordion-icon]");t&&(t.classList.add("hidden"),e.setAttribute("aria-expanded","false"),a)&&a.classList.remove("rotate-180")}),!t)&&(a.classList.remove("hidden"),e.setAttribute("aria-expanded","true"),r=e.querySelector("[data-accordion-icon]"))&&r.classList.add("rotate-180")}function updateTimeEstimator(e,t){var a,r=document.getElementById("time-display-"+e),d=document.getElementById("progressCircle-"+e);r&&(a=Math.round(10*t/60*10)/10,r.textContent=a.toFixed(1),d)&&((r=document.querySelector(`[id="questions-range-${e}"]`))?(a=parseInt(r.max),e=parseInt(t),r=Math.round(e/a*100),Math.round(r/100*50),setProgress(d,r)):setProgress(d,100))}function setProgress(e,t){var a;e&&(a=e.r.baseVal.value,a=2*Math.PI*a,e.style.strokeDasharray=a+" "+a,e.style.strokeDashoffset=a-t/100*a)}function updateDifficultySelection(e){document.querySelectorAll('input[name="difficulty"]').forEach(e=>{var t=document.querySelector(`label[for="${e.id}"]`);if(t){var a=e.getAttribute("data-difficulty");if(t.classList.remove("border-green-500","bg-green-50","dark:border-green-400","dark:bg-green-900/20","border-yellow-500","bg-yellow-50","dark:border-yellow-400","dark:bg-yellow-900/20","border-red-500","bg-red-50","dark:border-red-400","dark:bg-red-900/20","border-blue-500","bg-blue-50","dark:border-blue-400","dark:bg-blue-900/20"),t.classList.add("border-gray-200","dark:border-gray-600"),e.checked)switch(t.classList.remove("border-gray-200","dark:border-gray-600"),a){case"easy":t.classList.add("border-green-500","bg-green-50","dark:border-green-400","dark:bg-green-900/20");break;case"medium":t.classList.add("border-yellow-500","bg-yellow-50","dark:border-yellow-400","dark:bg-yellow-900/20");break;case"hard":t.classList.add("border-red-500","bg-red-50","dark:border-red-400","dark:bg-red-900/20");break;case"mixed":t.classList.add("border-blue-500","bg-blue-50","dark:border-blue-400","dark:bg-blue-900/20")}}})}function updateQuestionCount(e,t){e=document.getElementById("question-count-"+e);e&&(e.textContent=t)}function updateSliderValueDisplay(e,t,a){let r=document.getElementById("slider-value-"+t);var d,i;r&&(r.textContent=a,t=parseFloat(e.min),d=parseFloat(e.max),a=parseFloat(a),i=e.offsetWidth,r.style.left=(a-t)/(d-t)*(i-20)+10+"px",r.style.opacity="1",clearTimeout(r.hideTimeout),r.hideTimeout=setTimeout(()=>{e.matches(":hover")||e.matches(":focus")||(r.style.opacity="0")},1500))}function initializeAccordions(){document.querySelectorAll("[data-custom-accordion]").forEach(e=>{e.querySelectorAll("[data-accordion-target]").forEach((e,t)=>{var a=e.getAttribute("data-accordion-target"),a=document.querySelector(a),r=e.querySelector("[data-accordion-icon]");a&&(a.classList.add("hidden"),e.setAttribute("aria-expanded","false"),r)&&r.classList.remove("rotate-180")})})}function startQuiz(e,a,t,r){var d=a.replace(/[^a-zA-Z0-9]/g,"-"),i=document.getElementById("quiz-modal-"+d);if(i){i=i.querySelector('input[name="difficulty"]:checked');let e=i?i.getAttribute("data-difficulty"):"mixed";i=document.getElementById("questions-range-"+d);let t=i?i.value:10;submitQuizForm(a,e,t)}else void submitQuizForm(a,"mixed",10)}function submitQuizForm(e,t,a){var r=document.createElement("form"),e=(r.method="POST",r.action="/quiz/start/"+encodeURIComponent(e),document.createElement("input")),a=(e.type="hidden",e.name="questionCount",e.value=a,r.appendChild(e),document.createElement("input"));a.type="hidden",a.name="difficulty",a.value=t,r.appendChild(a),document.body.appendChild(r),r.submit()}window.updateTimeEstimator=updateTimeEstimator,document.addEventListener("click",function(e){var t,a=e.target.closest("[data-accordion-target]");a&&a.closest("[data-custom-accordion]")?handleCustomAccordionClick.call(a,e):((a=e.target.closest(".start-quiz-btn"))&&(e.preventDefault(),t=a.getAttribute("data-quiz-id"),startQuiz(a.getAttribute("data-quiz-title"),t,a.getAttribute("data-category"),a.getAttribute("data-subcategory"))),(t=e.target.closest(".cancel-quiz-btn"))&&(e.preventDefault(),a=t.getAttribute("data-modal-hide"),t=document.getElementById(a))&&(document.activeElement.blur(),t.classList.add("hidden"),t.setAttribute("aria-hidden","true"),t.removeAttribute("tabindex"),document.body.classList.remove("overflow-hidden")),(a=e.target.closest("label[for]"))&&(t=a.getAttribute("for"),e=document.getElementById(t))&&e.classList.contains("difficulty-radio")&&(e.checked=!0,updateDifficultySelection(e)))}),document.addEventListener("input",function(e){var t,a;"range"===e.target.type&&(updateQuestionCount(t=e.target.getAttribute("data-quiz-id"),a=e.target.value),updateTimeEstimator(t,a),updateSliderValueDisplay(e.target,t,a))}),document.addEventListener("change",function(e){var t;e.target.classList.contains("questions-range-slider")&&(updateQuestionCount(t=e.target.getAttribute("data-quiz-id"),e=e.target.value),updateTimeEstimator(t,e))}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".questions-range-slider, .enhanced-slider").forEach(t=>{var a=t.getAttribute("data-quiz-id"),r=t.value;if(updateQuestionCount(a,r),updateTimeEstimator(a,r),t.classList.contains("enhanced-slider")){updateSliderValueDisplay(t,a,r);let e=document.getElementById("slider-value-"+a);e&&(t.addEventListener("mouseenter",()=>{clearTimeout(e.hideTimeout),e.style.opacity="1"}),t.addEventListener("mouseleave",()=>{e.hideTimeout=setTimeout(()=>{t.matches(":focus")||(e.style.opacity="0")},500)}),t.addEventListener("focus",()=>{clearTimeout(e.hideTimeout),e.style.opacity="1"}),t.addEventListener("blur",()=>{e.hideTimeout=setTimeout(()=>{e.style.opacity="0"},500)}))}}),initializeAccordions();var e=document.querySelector('input[name="difficulty"]:checked');e&&updateDifficultySelection(e)});