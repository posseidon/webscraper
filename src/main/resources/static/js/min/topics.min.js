function updateTopicTimeEstimator(e,t){var i,a=document.getElementById("time-display-"+e),r=document.getElementById("progressCircle-"+e);a&&(i=Math.round(10*t/60*10)/10,a.textContent=i.toFixed(1),r)&&((a=document.querySelector(`[id="topic-questions-range-${e}"]`))?(i=parseInt(a.max),e=parseInt(t),setProgress(r,Math.round(e/i*100))):setProgress(r,100))}function setProgress(e,t){var i;e&&(i=e.r.baseVal.value,i=2*Math.PI*i,e.style.strokeDasharray=i+" "+i,e.style.strokeDashoffset=i-t/100*i)}function updateTopicDifficultySelection(e){e=e.id.replace(/^topic-(easy|medium|hard|mixed)-/,"");document.querySelectorAll(`input[name="topic-difficulty-${e}"]`).forEach(e=>{var t=document.querySelector(`label[for="${e.id}"]`);if(t){var i=e.getAttribute("data-difficulty");if(t.classList.remove("border-green-500","bg-green-50","dark:border-green-400","dark:bg-green-900/20","border-yellow-500","bg-yellow-50","dark:border-yellow-400","dark:bg-yellow-900/20","border-red-500","bg-red-50","dark:border-red-400","dark:bg-red-900/20","border-blue-500","bg-blue-50","dark:border-blue-400","dark:bg-blue-900/20"),t.classList.add("border-gray-200","dark:border-gray-600"),e.checked)switch(t.classList.remove("border-gray-200","dark:border-gray-600"),i){case"easy":t.classList.add("border-green-500","bg-green-50","dark:border-green-400","dark:bg-green-900/20");break;case"medium":t.classList.add("border-yellow-500","bg-yellow-50","dark:border-yellow-400","dark:bg-yellow-900/20");break;case"hard":t.classList.add("border-red-500","bg-red-50","dark:border-red-400","dark:bg-red-900/20");break;case"mixed":t.classList.add("border-blue-500","bg-blue-50","dark:border-blue-400","dark:bg-blue-900/20")}}})}function updateTopicSliderValueDisplay(e,t,i){let a=document.getElementById("slider-value-"+t);var r,d;a&&(a.textContent=i,t=parseFloat(e.min),r=parseFloat(e.max),i=parseFloat(i),d=e.offsetWidth,a.style.left=(i-t)/(r-t)*(d-20)+10+"px",a.style.opacity="1",clearTimeout(a.hideTimeout),a.hideTimeout=setTimeout(()=>{e.matches(":hover")||e.matches(":focus")||(a.style.opacity="0")},1500))}function playTopicQuiz(e,t){e?showTopicQuizModal(e):alert("Error: Topic ID is missing. Cannot start quiz.")}function showTopicQuizModal(i){var e=i.replace(/[^a-zA-Z0-9]/g,"-");let a=document.getElementById("topic-quiz-modal-"+e);if(a){a.classList.remove("hidden"),a.setAttribute("aria-hidden","false"),a.setAttribute("tabindex","0"),document.body.classList.add("overflow-hidden"),a.focus(),a.addEventListener("click",function(e){e.target===a&&hideTopicQuizModal(i)});let t=function(e){"Escape"===e.key&&(hideTopicQuizModal(i),document.removeEventListener("keydown",t))};document.addEventListener("keydown",t)}else startTopicQuizDirectly(i)}function hideTopicQuizModal(e){e=e.replace(/[^a-zA-Z0-9]/g,"-"),e=document.getElementById("topic-quiz-modal-"+e);e&&(e.classList.add("hidden"),e.setAttribute("aria-hidden","true"),e.removeAttribute("tabindex"),document.body.classList.remove("overflow-hidden"))}function startTopicQuizDirectly(e){var t=document.createElement("form");t.method="POST",t.action="/quiz/play/"+encodeURIComponent(e),document.body.appendChild(t),t.submit()}function startTopicQuiz(e,t,i,a,r){var d=document.querySelector(`input[name="topic-difficulty-${e.replace(/[^a-zA-Z0-9]/g,"-")}"]:checked`),d=d?d.getAttribute("data-difficulty"):"mixed",o=document.getElementById("topic-questions-range-"+e.replace(/[^a-zA-Z0-9]/g,"-")),o=o?parseInt(o.value):0,l=document.createElement("form"),e=(l.method="POST",l.action="/quiz/start/"+encodeURIComponent(e),document.createElement("input")),d=(e.type="hidden",e.name="difficulty",e.value=d,l.appendChild(e),document.createElement("input"));d.type="hidden",d.name="questionCount",d.value=o.toString(),l.appendChild(d),document.body.appendChild(l),l.submit()}window.updateTopicTimeEstimator=updateTopicTimeEstimator,document.addEventListener("click",function(e){var t,i=e.target.closest(".play-topic-quiz-btn");i?(e.preventDefault(),playTopicQuiz(i.getAttribute("data-topic-id"),i.getAttribute("data-topic-name"))):(i=e.target.closest(".topic-content-div"))?(e.preventDefault(),startTopicQuizDirectly(i.getAttribute("data-topic-id"))):(i=e.target.closest(".start-topic-quiz-btn"))?(e.preventDefault(),startTopicQuiz(i.getAttribute("data-topic-id"),i.getAttribute("data-topic-name"),i.getAttribute("data-category"),i.getAttribute("data-subcategory"),i.getAttribute("data-title"))):e.target.closest("#title-quiz-play-btn")?(e.preventDefault(),showTitleQuizModal()):(i=e.target.closest(".start-quiz-btn"))?(e.preventDefault(),t=i.getAttribute("data-quiz-id"),i=i.getAttribute("data-category"),startTitleQuiz(t,i)):((t=e.target.closest(".cancel-topic-quiz-btn"))&&(e.preventDefault(),(i=t.getAttribute("data-modal-hide"))&&i.startsWith("topic-quiz-modal-")?hideTopicQuizModal(i.replace("topic-quiz-modal-","").replace(/-/g," ")):(i=document.getElementById(i))&&(document.activeElement.blur(),i.classList.add("hidden"),i.setAttribute("aria-hidden","true"),i.removeAttribute("tabindex"),document.body.classList.remove("overflow-hidden"))),(i=e.target.closest("[data-modal-hide]"))&&!t&&(e.preventDefault(),(t=i.getAttribute("data-modal-hide"))&&t.startsWith("quiz-modal-")?hideTitleQuizModal():t&&t.startsWith("topic-quiz-modal-")?hideTopicQuizModal(t.replace("topic-quiz-modal-","").replace(/-/g," ")):(i=document.getElementById(t))&&(document.activeElement.blur(),i.classList.add("hidden"),i.setAttribute("aria-hidden","true"),i.removeAttribute("tabindex"),document.body.classList.remove("overflow-hidden"))),e.target.closest(".cancel-quiz-btn")&&(e.preventDefault(),hideTitleQuizModal()),(t=e.target.closest("label[for]"))&&(i=t.getAttribute("for"),e=document.getElementById(i))&&e.classList.contains("difficulty-radio")&&(e.checked=!0,(i.includes("topic-")?updateTopicDifficultySelection:updateMainQuizDifficultySelection)(e)))}),document.addEventListener("input",function(e){var t,i;"range"===e.target.type&&e.target.id.includes("topic-questions-range-")&&(updateTopicTimeEstimator(t=e.target.getAttribute("data-quiz-id"),i=e.target.value),updateTopicSliderValueDisplay(e.target,t,i)),"range"===e.target.type&&e.target.id.includes("questions-range-")&&(t=e.target.getAttribute("data-quiz-id"),i=e.target.value,updateMainQuizTimeEstimator(t,i),updateMainQuizSliderValueDisplay(e.target,t,i))});